/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package nyldons;


import java.util.List;

public class App {

    private final NyldonGenerator gen;

    public static void main(String[] args) {
        new App().run();
    }

    public App() {
        var comp = Setting.getComparator();
        var maxLength = Setting.maxLength;
        var alphabet = Setting.alphabet;

        if (!Setting.order.worksWithAlphabet(alphabet.size())) {
            throw new IllegalArgumentException("Order " + Setting.order.name() + " does not work with alphabet " + alphabet.name());
        }


        this.gen = new NyldonGenerator(comp, maxLength, alphabet);
    }

    public void run() {


        List<String> nyldon = switch (Setting.mode) {
            case Generate -> generate();
            case Check -> check();
        };


        FileUtil.writeToFile(nyldon, Setting.getOutputFilePath());

    }

    private List<String> check() {
        var nyldons = FileUtil.readFromFile(Setting.getInputFilePath());
        Setting.predicate.setup(nyldons, Setting.getComparator());
        return nyldons.stream()
                .filter(Setting.predicate.negate())
                .toList();
    }

    private List<String> generate() {
        return gen.generate();
    }


}
